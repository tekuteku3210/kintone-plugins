# チケット: TabView（タブビュー）- 初回リリース

**作成日**: 2026-01-04
**最終更新**: 2026-01-04
**ステータス**: 要件確定
**担当者**: Sakaguchi Takaya
**プラグイン名**: TabView（仮称）

---

## 概要

kintoneのレコード詳細画面で、フィールドをタブごとに分けて表示するプラグイン。長いフォームを見やすく整理し、ユーザビリティを向上させる。

### 差別化ポイント（競合調査を踏まえて）
- **無料 + 水平タブ**: 既存の無料プラグイン（Ribbit's works）は垂直タブのみ
- **簡単設定**: ドラッグ&ドロップ、プレビュー機能で直感的に設定
- **モダンUI**: React + Tailwind CSSで美しいインターフェース
- **充実したドキュメント**: README、動画チュートリアル、FAQ完備

---

## 背景・目的

### 課題
- kintoneで項目数が多いアプリでは、レコード詳細画面が縦に長くなりすぎて見づらい
- 関連するフィールドをグループ化して表示したい
- スクロールせずに必要な情報にアクセスしたい

### 目的
- レコード詳細画面をタブで整理し、見やすくする
- ユーザーが設定画面で簡単にタブを設定できるようにする
- プログラミング知識がなくても使えるプラグインを提供

### ターゲットユーザー
- 項目数の多いkintoneアプリを運用している企業
- 顧客管理、案件管理、人事管理などの複雑なアプリを使うユーザー

---

## 機能要件

### 1. タブ表示機能（レコード詳細画面）

#### 基本動作
- [x] レコード詳細画面にタブUIを表示
- [x] タブをクリックすると、該当するフィールドグループを表示
- [x] 初回表示時は最初のタブが選択された状態
- [x] 選択されていないタブのフィールドは非表示

#### タブUIの要件
- [ ] タブは画面上部に横並びで表示（**水平タブで差別化**）
- [ ] 現在選択中のタブは視覚的に強調（背景色変更、下線）
- [ ] 無料版: 最大5タブまで設定可能（Pro版: 無制限）
- [ ] レスポンシブデザイン
  - PC: 横並びタブ
  - タブレット: 横並びタブ（余白縮小）
  - スマホ: ドロップダウンに切り替え

#### フィールド表示制御
- [x] 各タブに割り当てられたフィールドのみ表示
- [x] どのタブにも割り当てられていないフィールドは、すべてのタブで表示（共通フィールド）
- [x] フィールドグループ、テーブルにも対応

### 2. 設定画面

#### タブ設定
- [x] タブを追加・削除できる
- [x] タブごとに以下を設定:
  - タブ名（必須、最大20文字）
  - タブアイコン（任意、Font Awesomeなどのアイコン）
  - 表示するフィールドのリスト（チェックボックスで選択）

#### UI/UX
- [x] **前提条件の表示**（Sociomedia HIG #32準拠）
  - 設定画面の冒頭に「無料プランでは最大5タブまで設定できます」と表示
  - タブ上限に達した場合「タブの上限に達しています。Proプランにアップグレードすると無制限に設定できます。」
- [x] ドラッグ&ドロップでタブの順序を変更可能
- [x] プレビュー機能（設定内容をその場で確認）
- [x] **具体的な動詞のボタンラベル**（Sociomedia HIG #47準拠）
  - ✅ OK: [タブを保存]、[変更を破棄]、[タブを削除]
  - ❌ NG: [保存]、[キャンセル]、[削除]

#### フィールド選択
- [x] アプリのフィールド一覧を自動取得して表示
- [x] フィールドグループごとにまとめて選択可能
- [x] 検索機能（フィールド名で絞り込み）

### 3. エラーハンドリング

#### エラーメッセージの要件（Sociomedia HIG #55準拠）
- [x] タブが1つも設定されていない場合: デフォルト表示（タブなし）
- [x] **建設的なエラーメッセージ**: 原因と解決策を明示
  - ❌ NG: 「設定の保存に失敗しました」
  - ✅ OK: 「タブ名を入力してください」「ネットワークエラーが発生しました。もう一度お試しください。」
- [x] **エラーの種類別メッセージ**:
  - バリデーションエラー: 「タブ名は20文字以内で入力してください」
  - 必須入力エラー: 「タブ名を入力してください」
  - 重複エラー: 「このタブ名は既に使用されています。別の名前を入力してください。」
  - ネットワークエラー: 「ネットワークエラーが発生しました。もう一度お試しください。」
  - 権限エラー: 「このフィールドにアクセスする権限がありません」

---

## 非機能要件

### パフォーマンス
- [x] タブ切り替えは即座に反応（100ms以内）
- [x] フィールド数が100個以上でも動作が遅くならない

### ブラウザ互換性
- [x] Chrome（最新版）
- [x] Edge（最新版）
- [x] Safari（最新版）
- [x] Firefox（最新版）

### セキュリティ
- [x] XSS対策（ユーザー入力をエスケープ）
- [x] kintoneのアクセス権限を尊重（権限のないフィールドは表示しない）

---

## 技術スタック

### 言語・フレームワーク
- **言語**: TypeScript
- **UIフレームワーク**: React（設定画面・レコード画面で使用）
- **ビルドツール**: webpack
- **CSS**: Tailwind CSS
- **パッケージマネージャー**: npm（pnpmも検討）

### 理由（Ribbit's works コード分析を踏まえて）
- **TypeScript**: 型安全性が重要（フィールド設定の管理）
- **React**: 動的なタブUI・設定画面に最適（Ribbitにはない差別化）
- **Tailwind CSS**: 素早くモダンなUIを構築（Ribbitと同じ）
- **環境別設定分離**: config/desktopディレクトリを分けてTailwind設定も分離（Ribbitのパターンを採用）

### kintone API
- `kintone.app.record.getFieldElement()`: フィールド要素の取得
- `kintone.plugin.app.getConfig()`: プラグイン設定の取得
- `kintone.plugin.app.setConfig()`: プラグイン設定の保存
- `kintone.app.getFieldElements()`: 全フィールド要素の取得

---

## データ設計

### プラグイン設定データ（JSON）

```json
{
  "tabs": [
    {
      "id": "tab1",
      "label": "基本情報",
      "icon": "user",
      "fields": ["氏名", "メールアドレス", "電話番号"]
    },
    {
      "id": "tab2",
      "label": "詳細情報",
      "icon": "info-circle",
      "fields": ["住所", "会社名", "部署"]
    }
  ],
  "commonFields": ["レコード番号", "作成者", "更新者"]
}
```

### 設定項目の説明

| 項目 | 型 | 必須 | 説明 |
|------|---|------|------|
| tabs | Array | Yes | タブの配列 |
| tabs[].id | String | Yes | タブの一意ID（自動生成） |
| tabs[].label | String | Yes | タブ名（最大20文字） |
| tabs[].icon | String | No | Font Awesomeアイコン名 |
| tabs[].fields | Array | Yes | 表示するフィールドコードの配列 |
| commonFields | Array | No | すべてのタブで表示するフィールド |

---

## 画面設計

### 1. レコード詳細画面（タブUI）

```
┌─────────────────────────────────────────────────┐
│ kintone レコード詳細画面                        │
├─────────────────────────────────────────────────┤
│  [ 基本情報 ] [ 詳細情報 ] [ 履歴 ] [ メモ ]   │ ← タブ
├─────────────────────────────────────────────────┤
│                                                 │
│  【基本情報タブの内容】                         │
│                                                 │
│  氏名: 山田太郎                                 │
│  メールアドレス: yamada@example.com             │
│  電話番号: 090-1234-5678                        │
│                                                 │
│  【共通フィールド】                             │
│  作成者: admin                                  │
│  更新者: admin                                  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 2. 設定画面

```
┌─────────────────────────────────────────────────┐
│ TabView プラグイン設定                          │
├─────────────────────────────────────────────────┤
│                                                 │
│  【タブ一覧】                 [+ タブ追加]     │
│                                                 │
│  1. 基本情報 👤              [編集] [削除]     │
│     フィールド: 氏名, メール, 電話番号          │
│                                                 │
│  2. 詳細情報 ℹ️              [編集] [削除]     │
│     フィールド: 住所, 会社名, 部署              │
│                                                 │
│  ─────────────────────────────────────────      │
│                                                 │
│  【タブ編集】                                   │
│  タブ名: [基本情報          ]                  │
│  アイコン: [user ▼          ]                  │
│                                                 │
│  表示フィールド:                                │
│  ☑ 氏名                                         │
│  ☑ メールアドレス                               │
│  ☑ 電話番号                                     │
│  ☐ 住所                                         │
│  ☐ 会社名                                       │
│                                                 │
│              [保存]  [キャンセル]               │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 開発タスク

### Phase 1: 環境構築（1-2日）
- [x] プロジェクトディレクトリ作成
- [ ] TypeScript + React環境のセットアップ
- [ ] webpack設定
- [ ] package.json作成
- [ ] 基本的なディレクトリ構成作成

### Phase 2: 設定画面開発（3-5日）
- [ ] 設定画面のHTML/CSS作成
- [ ] タブ追加・削除機能
- [ ] フィールド選択UI
- [ ] 設定の保存・読み込み機能
- [ ] プレビュー機能

### Phase 3: レコード画面タブUI（3-5日）
- [ ] タブUIコンポーネント作成
- [ ] フィールド表示制御ロジック
- [ ] タブ切り替え機能
- [ ] 共通フィールド表示機能
- [ ] スタイリング（Tailwind CSS）

### Phase 4: テスト（2-3日）
- [ ] 単体テスト作成
- [ ] 複数のkintoneアプリでテスト
- [ ] ブラウザ互換性テスト
- [ ] パフォーマンステスト（大量フィールド）
- [ ] エラーハンドリングテスト

### Phase 5: ドキュメント作成（1-2日）
- [ ] README作成（使い方、スクリーンショット）
- [ ] ヘルプドキュメント
- [ ] プライバシーポリシー
- [ ] リリースノート

### Phase 6: リリース準備（1日）
- [ ] プラグインのパッケージング
- [ ] GitHubリポジトリ作成・公開
- [ ] kintone プラグインマーケットへの申請準備

**総開発期間**: 約2-3週間（週末のみ開発の場合: 1.5-2ヶ月）

---

## リスクと対策

### リスク1: フィールド要素の取得が難しい
**リスク**: kintoneのDOM構造が複雑で、フィールド要素を正確に取得できない可能性
**対策**:
- `kintone.app.record.getFieldElement()`を使用
- 公式ドキュメントを参照して実装
- テストアプリで十分に検証

### リスク2: パフォーマンス問題
**リスク**: フィールド数が多い場合、タブ切り替えが遅くなる
**対策**:
- 仮想DOM（React）で効率的に描画
- フィールドの表示/非表示はCSSで制御（`display: none`）
- 初回レンダリング時にすべてのフィールドを取得してキャッシュ

### リスク3: ブラウザ互換性
**リスク**: 一部のブラウザで動作しない
**対策**:
- Babelでトランスパイル（ES5互換）
- Polyfillを使用
- 主要ブラウザで動作確認

---

## 成功指標

### 定量指標
- [ ] GitHubスター数: 10以上
- [ ] kintone プラグインマーケットでのダウンロード数: 50以上
- [ ] バグ報告: 重大なバグ0件

### 定性指標
- [ ] ユーザーから「使いやすい」というフィードバック
- [ ] kintone コミュニティでの言及

---

## 将来の拡張機能（Phase 2以降）

### v2.0
- [ ] タブアイコンのカスタマイズ（画像アップロード）
- [ ] タブごとに表示条件を設定（特定のユーザーのみ表示など）
- [ ] タブの表示/非表示をレコードの値に応じて動的に変更

### v3.0
- [ ] タブ内でさらにサブタブを作成
- [ ] タブテンプレート機能（よく使う設定を保存）
- [ ] 複数アプリで設定を共有

---

## 参考資料

### kintone公式ドキュメント
- [kintone JavaScript API](https://developer.cybozu.io/hc/ja/articles/201941754)
- [プラグイン開発ガイド](https://developer.cybozu.io/hc/ja/articles/360045017354)

### 類似プラグイン（競合調査済み）
- [Ribbit's works - タブ表示プラグイン](https://ribbit.konomi.app/kintone-plugin/tab/) - 無料・オープンソース・垂直タブ
- [GitHub: kintone-plugin-tab](https://github.com/local-bias/kintone-plugin-tab) - Ribbitのソースコード
- [株式会社アディエム](https://adiem.jp/kintone-plugin/tabview/) - 有料・買い切り
- [rex0220](https://rex0220.stores.jp/items/56e6a74fef337717fd001072) - ¥55,000/サイト
- [株式会社ジョイゾー](https://www.joyzo.co.jp/service/plugin/tabview/) - 月額¥3,900〜

### デザイン参考
- [Bootstrap Tabs](https://getbootstrap.com/docs/5.0/components/navs-tabs/)
- [Material-UI Tabs](https://mui.com/material-ui/react-tabs/)

### プロジェクト内ドキュメント
- [競合分析レポート](../competitive-analysis.md)
- [Ribbitコード分析](../ribbit-code-analysis.md)
- [UI/UXモックアップ](../ui-mockup.md)

---

**ドキュメント終わり**
